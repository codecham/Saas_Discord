// apps/backend/prisma/migrations/add_welcome_module.sql
// À ajouter à la fin du fichier schema.prisma

// ============================================
// WELCOME MODULE
// ============================================

model WelcomeConfig {
  id              String   @id @default(cuid())
  guildId         String   @unique @map("guild_id")
  enabled         Boolean  @default(true)
  
  // Configuration du channel
  channelId       String?  @map("channel_id")  // null = use system channel
  
  // Type de message
  messageType     String   @default("text") @map("message_type")  // 'text' | 'embed'
  
  // Contenu du message (avec variables)
  messageContent  String   @map("message_content") @db.Text
  
  // Embed settings (Premium only)
  embedColor      String?  @map("embed_color")      // Hex color
  embedTitle      String?  @map("embed_title")
  embedDescription String? @map("embed_description") @db.Text
  embedThumbnail  String?  @map("embed_thumbnail")  // URL
  embedFooter     String?  @map("embed_footer")
  
  // Timestamps
  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")
  
  // Relations
  guild           Guild    @relation(fields: [guildId], references: [discordGuildId], onDelete: Cascade)

  @@map("welcome_configs")
  @@index([guildId])
  @@index([enabled])
}

// IMPORTANT: Ajouter cette relation dans le model Guild existant :
// welcomeConfig WelcomeConfig?
